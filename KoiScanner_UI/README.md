# KoiScanner UI Version
This work alone but **_you will require to add in your own API key from Cloudmersive and IPqualityScore_**.

**Note that you may need to install some packages to be able to run the programme.**

##  Lines that require API Key from Cloudmersive
Lines 144 & 235 requires you to key in Cloudmersive API Key

The Link to obtain Cloudmersive API Key is [here](https://cloudmersive.com/virus-api)

## Lines that require API Key from IPQualityScore
Line 282 requires you to key in IPQualityScore API Key

The Link to obtain IPQualityScore API Key is [here](https://www.ipqualityscore.com)

# Filename and It's Purpose

1) `KoiScanner.ipynb` is the Jupyter Notebook Version of python Codes.

2) `koiscanner.py`  are the codes that you can run locally on your machine.

3) `malicious.csv` is the dataset that contain MALICIOUS URLs only.

4) `scanemail.csv` is the dataset generated by KoiScanner.ipynb to draw out a graph. 

# Explanation of the Email Scanner
![image](https://user-images.githubusercontent.com/86769746/130252484-f4e621ae-3770-40ed-b368-ae18d6547364.png)
#### This uses the CSV dataset that contains the malicious URLs which uses PhishTank through this link [here](https://www.phishtank.com/developer_info.php).

![image](https://user-images.githubusercontent.com/86769746/130253607-a660f1c6-34f3-4366-acec-14eeb3f03613.png)
#### Connects to the user's email and password and scans all the Inbox emails. Furthermore, message_numbers are the id for each of the emails.

![image](https://user-images.githubusercontent.com/86769746/130253764-62168ce9-96ff-47d0-aabc-d0c7649cf9d8.png)
#### The email scanner uses the Tkinker GUI package to create the windows to scan the emails or URLs and the email results and email attachments results.

![image](https://user-images.githubusercontent.com/86769746/130254657-a4789896-0db1-46a4-a9c1-3a381791a80c.png)
#### For every email ID in the Inbox, it will get an electronic message format consisting of header fields and an optional message body of the email. It will get the data of the email like subject,from, to, date, message ID, SPF and sender's IP address.

![image](https://user-images.githubusercontent.com/86769746/130255543-b81dade3-f9db-41bf-b573-8e5d588305a2.png)
#### If the email contains an attachment, it will download the attachment on the host with the attachment stored on a file named through the message ID.

![image](https://user-images.githubusercontent.com/86769746/130256342-e021c174-ae7b-4610-b471-4d2a2f47d30c.png)
#### The email scanner uses the Cloudmersive API which leverages continuously updated signatures for millions of threats, and advanced high-performance scanning capabilities with over 17 million virus and malware signatures through continuous cloud-based updates. It will scan the attachment whether it is executable, valid file format, contains a script, password protected, macros and XML file or not. Once scanned, it will save the results in the api_response and uses the results to log and alert the user whether or not the attachments found contains viruses or not.

![image](https://user-images.githubusercontent.com/86769746/130257460-f7b70df3-c779-4ebd-b3dd-a5ebc4654bfd.png)
#### This results will be saved into a dictionary that will print the result on a new window with the logs.

![image](https://user-images.githubusercontent.com/86769746/130257635-1f76c4d4-6304-4204-b4e9-60eafd49fc3d.png)
#### Next, the email scanner will scan every word in each of the email and check whether or not there is a link in the meail that matches the CSV file that contain malicious URL from the PhishTank. Then, it uses the VirusTotal API which detects malicious content and identifying false positives through multiple examining partners and vendors, to double check if the link is indeed malicious. If there are more than 1 response_code which means at least a scanner from the vendors found it malicious, it will deemed as malicious.

![image](https://user-images.githubusercontent.com/86769746/130258669-dac8589d-fa2e-45ac-9096-cf9515642e85.png)
#### The email scanner will then scan and search information on the sender through its IP address using Cloudmersive API. It will check whether if the sender of the email is a threat, bot, using tor or not and their location.

![image](https://user-images.githubusercontent.com/86769746/130259029-e1bf934b-48f3-41ca-9739-e9ac62e4d09e.png)
#### Next, the email scanner uses the IPQualityServer API to scan the malicious URL found and its information. IPQualityScore's real-time Malicious URL Scanner API scans links in real-time to detect suspicious URLs and accurately identify phishing links, malware URLs and viruses, parked domains, and suspicious URLs with real-time risk scores which can be integrated directly into the scanner to accurately check URLs for malware without false-positives or missed hit rates. The email scanner will encode the malciious URL and use the API to check the URL information.

![image](https://user-images.githubusercontent.com/86769746/130259795-d8ff5bf3-0a6e-4ab6-ae9c-6c510a653bf1.png)
#### These results will be stored in another dictionary on a new window to show the scan and the log of the email, sender's IP information and the malicious domain information.

![image](https://user-images.githubusercontent.com/86769746/130260064-acf7e43a-679f-4bd0-8444-8faf6b11b2c3.png)
#### After that, all the malicious emails with the malicious URL will be moved from the Inbox to a new label/folder called 'malicious' and store them there.

![image](https://user-images.githubusercontent.com/86769746/130260280-939934c6-5ebb-48cb-8979-ffdf3bf43826.png)
#### The email scanner will also check whether or not if the email is a spam or bot through the Sender Policy Framwork which gives a PASS, SOFTFAIL or FAIL. If it is not PASS, it will move the email to the malicious folder as well.

![image](https://user-images.githubusercontent.com/86769746/130260523-4194c849-1a35-4851-8b14-73c5489d6ee8.png)
#### This scans and plot the graph on when did the user used the email scanner and how many malicious link it has found.

![image](https://user-images.githubusercontent.com/86769746/130260878-9d9cbfa7-5e45-4f6c-a319-b7b4ef6d8830.png)
#### Creates the new windows and logout the email account after it has completed the scan.

![image](https://user-images.githubusercontent.com/86769746/130261012-9f952bef-a81e-47c2-b861-c2f6f3282000.png)
#### The email scanner will scan the link that the user has input and check whether or not if the link sent is malicious or not.

![image](https://user-images.githubusercontent.com/86769746/130261169-fc4a0880-518f-49ba-9349-28dbfc7329d5.png)
#### Use an image for the KoiScanner and loop the Tkinker package.

# Results for the output of the scanned email logs

# Email attachment log:
![image](https://user-images.githubusercontent.com/86769746/130233959-781f1830-c289-4d88-983b-07d9755d49a5.png)

# Email scanned result and logs for Email, Sender's IP address information and malicious domain information:
![image](https://user-images.githubusercontent.com/86769746/130234215-33b08814-a316-4147-a54d-5fe01c020063.png)

# Number of found malcious links per scan graph:
![image](https://user-images.githubusercontent.com/86769746/130234327-7a411441-50f1-48f6-a09d-fbc47844716b.png)

